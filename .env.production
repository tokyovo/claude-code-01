# =================================
# Personal Finance Tracker - Production Environment Configuration
# SECURITY WARNING: Never commit this file to version control with real values
# Use this as a template and populate with actual production values
# =================================

# =================================
# Application Configuration
# =================================
NODE_ENV=production
PORT=3000
HOST=0.0.0.0

# API Configuration
API_PREFIX=/api
API_VERSION=v1
API_RATE_LIMIT_WINDOW_MS=900000
API_RATE_LIMIT_MAX_REQUESTS=100

# =================================
# Database Configuration (PostgreSQL)
# =================================
# REQUIRED: Set these values for production
DB_HOST=postgres
DB_PORT=5432
DB_NAME=personal_finance_tracker
DB_USER=postgres
DB_PASSWORD=CHANGE_THIS_SECURE_PASSWORD

# SSL Configuration
DB_SSL=false
DB_SSL_REJECT_UNAUTHORIZED=false

# Connection Pool Configuration (Production Optimized)
DB_POOL_MIN=5
DB_POOL_MAX=30
DB_ACQUIRE_TIMEOUT_MS=60000
DB_CREATE_TIMEOUT_MS=60000
DB_IDLE_TIMEOUT_MS=600000

# Query Configuration
DB_QUERY_TIMEOUT_MS=30000
DB_STATEMENT_TIMEOUT_MS=30000

# Debug Configuration (Disabled in Production)
DEBUG_SQL=false
LOG_QUERIES=false

# Migration Configuration
RUN_MIGRATIONS_ON_STARTUP=false
RUN_SEEDS_ON_STARTUP=false

# =================================
# Redis Configuration
# =================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_THIS_SECURE_REDIS_PASSWORD
REDIS_DB=0
REDIS_KEY_PREFIX=finance_tracker_prod:

# Redis Connection Options (Production)
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000
REDIS_RETRY_DELAY_ON_FAILOVER=100
REDIS_MAX_RETRIES_PER_REQUEST=3

# =================================
# Security Configuration
# =================================
# CRITICAL: Generate secure secrets for production
JWT_SECRET=CHANGE_THIS_TO_A_VERY_SECURE_SECRET_KEY_AT_LEAST_64_CHARACTERS
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=CHANGE_THIS_TO_A_DIFFERENT_VERY_SECURE_REFRESH_SECRET_KEY
JWT_REFRESH_EXPIRES_IN=7d

# Password Security
BCRYPT_ROUNDS=12

# CORS Configuration (Production)
CORS_ORIGIN=https://yourdomain.com
CORS_CREDENTIALS=true

# Security Headers
ENABLE_HELMET=true
ENABLE_RATE_LIMITING=true
FORCE_HTTPS=true
HSTS_MAX_AGE=31536000

# =================================
# Logging Configuration (Production)
# =================================
LOG_LEVEL=warn
LOG_FORMAT=json
LOG_FILE_PATH=/app/logs/app.log
LOG_MAX_SIZE=50m
LOG_MAX_FILES=10
LOG_DATE_PATTERN=YYYY-MM-DD

# Disable verbose logging in production
LOG_HTTP_REQUESTS=false
LOG_DATABASE_QUERIES=false
LOG_ERROR_STACK_TRACES=true

# =================================
# File Upload Configuration
# =================================
UPLOAD_MAX_FILE_SIZE=5242880
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/gif,application/pdf
UPLOAD_DESTINATION=/app/uploads
UPLOAD_TEMP_DESTINATION=/app/uploads/temp

# =================================
# Email Configuration
# =================================
# REQUIRED: Configure SMTP for production
EMAIL_HOST=your-smtp-server.com
EMAIL_PORT=587
EMAIL_USER=noreply@yourdomain.com
EMAIL_PASSWORD=YOUR_EMAIL_PASSWORD
EMAIL_FROM=Personal Finance Tracker <noreply@yourdomain.com>

# Email Security
EMAIL_SECURE=true
EMAIL_TLS_REJECT_UNAUTHORIZED=true

# Email Features
ENABLE_EMAIL_VERIFICATION=true
ENABLE_PASSWORD_RESET_EMAIL=true
ENABLE_SECURITY_ALERTS=true
EMAIL_VERIFICATION_EXPIRY=24h
PASSWORD_RESET_EXPIRY=1h

# =================================
# Backup Configuration
# =================================
AUTO_BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_DESTINATION=/backups
BACKUP_COMPRESSION=true

# Cloud Storage for Backups (Optional - Configure if using cloud backups)
BACKUP_CLOUD_PROVIDER=
BACKUP_CLOUD_BUCKET=
BACKUP_CLOUD_REGION=
BACKUP_CLOUD_ACCESS_KEY=
BACKUP_CLOUD_SECRET_KEY=

# =================================
# Monitoring & Analytics
# =================================
# Health Checks
ENABLE_HEALTH_CHECKS=true
HEALTH_CHECK_PATH=/health
METRICS_PATH=/metrics

# Performance Monitoring
ENABLE_PERFORMANCE_MONITORING=true
SLOW_QUERY_THRESHOLD_MS=1000
SLOW_REQUEST_THRESHOLD_MS=2000

# Error Tracking (Optional - Configure if using error tracking service)
ERROR_TRACKING_DSN=
ENABLE_ERROR_TRACKING=false

# =================================
# Performance Configuration
# =================================
# Compression
ENABLE_COMPRESSION=true
COMPRESSION_LEVEL=6
COMPRESSION_THRESHOLD=1024

# Caching
CACHE_DEFAULT_TTL=300
CACHE_MAX_KEYS=10000
ENABLE_QUERY_CACHE=true
ENABLE_RESPONSE_CACHE=false

# ETag Support
ENABLE_ETAG=true

# =================================
# Session Configuration
# =================================
SESSION_SECRET=CHANGE_THIS_TO_A_VERY_SECURE_SESSION_SECRET_KEY
SESSION_MAX_AGE=86400000
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict

# =================================
# External API Configuration
# =================================
# Bank Account Integration (Optional - Configure if using Plaid)
PLAID_CLIENT_ID=
PLAID_SECRET=
PLAID_PUBLIC_KEY=
PLAID_ENVIRONMENT=production

# Currency Exchange Rates (Optional)
EXCHANGE_RATE_API_KEY=
EXCHANGE_RATE_BASE_CURRENCY=USD
EXCHANGE_RATE_UPDATE_INTERVAL=3600000

# =================================
# Feature Flags
# =================================
ENABLE_BUDGET_ALERTS=true
ENABLE_CATEGORY_SUGGESTIONS=true
ENABLE_TRANSACTION_CATEGORIZATION=true
ENABLE_RECURRING_TRANSACTIONS=true
ENABLE_MULTI_CURRENCY=false
ENABLE_INVESTMENT_TRACKING=false
ENABLE_GOAL_TRACKING=true

# =================================
# Development Overrides (Disabled in Production)
# =================================
ENABLE_HOT_RELOAD=false
ENABLE_DEBUG_MIDDLEWARE=false
ENABLE_PRETTY_LOGS=false
SEED_SAMPLE_DATA=false
SEED_RESET_ON_RESTART=false

# =================================
# Docker Compose Variables
# =================================
# These are used by docker-compose.prod.yml
POSTGRES_DB=personal_finance_tracker
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE_THIS_SECURE_PASSWORD

# Container Ports
APP_PORT=3000
POSTGRES_PORT=5432
REDIS_PORT=6379

# Data Paths
POSTGRES_DATA_PATH=./data/postgres
BACKUP_PATH=./data/backups

# SSL Certificate Paths (if using SSL)
SSL_CERT_PATH=./ssl/certs/fullchain.pem
SSL_KEY_PATH=./ssl/certs/privkey.pem
SSL_DHPARAM_PATH=./ssl/dhparam/dhparam.pem

# =================================
# PM2 Configuration
# =================================
PM2_INSTANCES=max
PM2_MAX_MEMORY=2048M

# =================================
# Build Configuration
# =================================
BUILD_DATE=2024-01-01T00:00:00Z
VERSION=1.0.0
GIT_COMMIT=

# =================================
# Monitoring Services (Optional)
# =================================
# Grafana
GRAFANA_PASSWORD=CHANGE_THIS_SECURE_GRAFANA_PASSWORD

# Prometheus
PROMETHEUS_RETENTION_TIME=15d

# =================================
# Load Balancer Configuration (Optional)
# =================================
LOAD_BALANCER_ENABLED=false
LOAD_BALANCER_ALGORITHM=round_robin

# =================================
# Rate Limiting (Production Values)
# =================================
GLOBAL_RATE_LIMIT_WINDOW=900000
GLOBAL_RATE_LIMIT_MAX=1000
AUTH_RATE_LIMIT_WINDOW=900000
AUTH_RATE_LIMIT_MAX=5

# =================================
# Security Scanning (Optional)
# =================================
SECURITY_SCAN_ENABLED=false
VULNERABILITY_SCAN_SCHEDULE=0 4 * * 0

# =================================
# Maintenance Mode
# =================================
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=System is currently under maintenance. Please try again later.

# =================================
# Environment Validation
# =================================
# The application will validate these required variables on startup
REQUIRED_ENV_VARS=NODE_ENV,PORT,DB_HOST,DB_NAME,DB_USER,DB_PASSWORD,REDIS_HOST,JWT_SECRET,JWT_REFRESH_SECRET

# =================================
# Notes for Production Deployment
# =================================
# 1. Generate secure random values for all secrets using: openssl rand -base64 64
# 2. Use environment-specific values for database and Redis hosts
# 3. Configure proper SSL certificates
# 4. Set up monitoring and alerting
# 5. Configure automated backups
# 6. Set up log rotation and monitoring
# 7. Review and test all security configurations
# 8. Ensure proper firewall and network security
# 9. Configure process monitoring (PM2 or equivalent)
# 10. Set up health checks and monitoring dashboards